<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="../assets/css/style.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha512-DxV+EoADOkOygM4IR9yXP8Sb2qwgidEmeqAEmDKIOfPRQZOWbXCzLC6vjbZyy0vPisbH2SyW27+ddLVCN+OMzQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/7.1.0/fuse.min.js" integrity="sha512-H1bWCnc4dDJwdioqpOCkU76ZxEdvBvOy9R9Dd9EqftlzQg92owjX5IVdiOw00llAyQFUZJNPrzDnWZ/lZtf25A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <title>Documentation TileMapEditor</title>
    <link rel="icon" href="../assets/images/search.ico" />
</head>
<body>
  <header>
    <nav>
      <a class="nav-left" href="https://github.com/zerosh0/TileMapEditor" target="_blank">
        <img src="../assets/images/github.svg" alt="GitHub" id="github"/>
        <h1 id="title">TileMapEditor</h1>
      </a>
  <div id="search-container">
    <input id="search" placeholder="Rechercher‚Ä¶" autocomplete="off" />
    <div id="search-results"></div>
  </div>
    </nav>
  </header>
    <button id="mobile-menu-btn" aria-label="Ouvrir le menu" class="mobile-menu-btn">
    &#9776;
    </button>

  <img id="illustration" src="../assets/images/illustration.svg" alt="Illustration" />

  <div class="layout">


<aside class="sidebar-left">
  <nav>
    <ul class="menu">
      <li>
        <a href="../index.html">Accueil</a>
      </li>

      <li>
        <a href="getting-started.html">Prise en main</a>
      </li>

      <li class="has-sub">
        <div class="menu-item">
          <span class="toggle-icon"><i class="fas fa-chevron-down"></i></span>
          <a href="interface.html">Interface</a>
        </div>
        <ul class="submenu">
          <li><a href="interface.html#viewport">Viewport</a></li>
          <li><a href="interface.html#tilepalette">Tile Palette</a></li>
          <li><a href="interface.html#layers">Layers</a></li>
          <li><a href="interface.html#tools">Outils</a></li>
        </ul>
      </li>

      <li class="has-sub">
        <div class="menu-item">
          <span class="toggle-icon"><i class="fas fa-chevron-down"></i></span>
          <a href="animations.html#">Animations</a>
        </div>
        <ul class="submenu">
          <li><a href="animations.html#intro">Pr√©sentation</a></li>
          <li><a href="animations.html#animation-editor">√âditeur d'animation</a></li>
          <li><a href="animations.html#timeline">Timeline</a></li>
          <li><a href="animations.html#playmode-integration">Int√©gration au mode Play</a></li>
        </ul>
      </li>

      <li class="has-sub">
        <div class="menu-item">
          <span class="toggle-icon"><i class="fas fa-chevron-down"></i></span>
          <a href="editor_nodal.html#">√âditeur Nodal</a>
        </div>
        <ul class="submenu">
          <li><a href="editor_nodal.html#overview">Pr√©sentation</a></li>
          <li><a href="editor_nodal.html#node-types">Types de n≈ìuds</a></li>
          <li><a href="editor_nodal.html#errors">Erreurs & validation</a></li>
          <li><a href="editor_nodal.html#custom-nodes">Nodes personnalis√©s</a></li>
        </ul>
      </li>

      <li class="has-sub">
        <div class="menu-item">
          <span class="toggle-icon"><i class="fas fa-chevron-down"></i></span>
          <a href="settings.html" >Param√®tres</a>
        </div>
        <ul class="submenu">
        <li><a href="settings.html#world-settings">World Settings</a></li>
        <li><a href="settings.html#player-profile">Player Profile</a></li>
        <li><a href="settings.html#advanced">Param√®tres Avanc√©s</a></li>
        </ul>
      </li>

      <li class="has-sub">
        <div class="menu-item">
          <span class="toggle-icon"><i class="fas fa-chevron-down"></i></span>
          <a href="#" class="active">Stockage & Donn√©es</a>
        </div>
        <ul class="submenu">
          <li><a href="#level">Niveau</a></li>
          <li><a href="#tilemaps">TileMaps</a></li>
          <li><a href="#animations">Animations</a></li>
          <li><a href="#nodes">Nodes</a></li>
          <li><a href="#parameters">Param√®tres</a></li>
        </ul>
      </li>

        <li>
        <a href="references.html">Biblioth√®que</a>
      </li>

    </ul>
  </nav>
</aside>





<main class="content">
  <div class="inner">
    <article>

      <h1 id="level">Niveau</h1>
      <p>
        Un niveau est stock√© en JSON, d√©crivant l'ensemble des calques, collisions, points de localisation, lumi√®res, √©tat de l'√©diteur et chemin vers le LevelGraph.
      </p>
      <pre><code class="language-json">
// Extrait d'un fichier level.json
{
  "layers": [
    {
      "opacity": 1.0,
      "tiles": [
        {
          "TileMap": "dungeon",
          "x": 18, "y": 19,
          "Originalx": 1, "Originaly": 1,
          "rotation": 0,
          "flipHorizontal": false,
          "flipVertical": false
        },
        /* ‚Ä¶ autres tuiles ‚Ä¶ */
      ]
    },
    /* layers 1 √† 8 vides ou partiellement remplies */
  ],
  "currentLayer": 0,
  "currentTool": "LocationPoint",
  "viewport": {
    "panningOffset": [-456.0, -508.5],
    "zoom": 2.5
  },
  /* ‚Ä¶ autres sections ‚Ä¶ */
}
      </code></pre>
      <h2 id="coords">üìê Coordonn√©es & dimensions</h2>
      <ul>
        <li><code>x, y</code> : position de la tuile dans le monde (grille)</li>
        <li><code>Originalx, Originaly</code> : indices de la tuile dans la source TileMap</li>
        <li><code>rotation</code> : angle en degr√©s (0, 90, 180, 270)</li>
        <li><code>flipHorizontal</code> / <code>flipVertical</code> : retournement</li>
      </ul>
      <h2 id="tilemaps">TileMaps</h2>
      <p>
        La section <code>tilePalette</code> d√©crit les tilesets charg√©s :
      </p>
      <pre><code class="language-json">
"tilePalette": {
  "currentTileMapIndex": 0,
  "tileMaps": [
    {
      "name": "dungeon",
      "filepath": "C:\\‚Ä¶\\Dungeon Tile Set.png",
      "tileSize": 16,
      "colorKey": null,
      "zoom": 1.0,
      "panningOffset": [0, 0]
    }
  ]
}
      </code></pre>
      <div class="alert alert-info">
        <div class="alert-body">
          <strong>Info :</strong> Les chemins de TileMap sont enregistr√©s en absolu ; si vous d√©placez vos dossiers, √©ditez manuellement ou remplacez-les par des chemins relatifs.
        </div>
      </div>

      <h2 id="animations">Animations</h2>
      <p>
        La section <code>animations</code> liste chaque animation avec son nom, dur√©e, vitesse, boucle, √©tat de lecture et ses keyframes :
      </p>
      <pre><code class="language-json">
"animations": [
  {
    "name": "animation_1",
    "end": 2.0,
    "speed": 1.0,
    "loop": false,
    "play": false,
    "keyframes": []
  },
  {
    "name": "test",
    "end": 1.5,
    "speed": 2.0,
    "loop": true,
    "play": true,
    "keyframes": [
      {
        "tile_map": "dungeon",
        "x": 24, "y": 20,
        "layer": 0,
        "time": 0.402,
        "Originalx": 3, "Originaly": 5,
        "rotation": 0, "flipH": false, "flipV": false
      },
      /* ‚Ä¶ autres keyframes ‚Ä¶ */
    ]
  }
]
      </code></pre>
      <h3 id="anim-keyframes">üîë Keyframes de suppression</h3>
      <p>
        Quand vous supprimez une tuile anim√©e, un keyframe de suppression est g√©n√©r√© :  
      </p>
      <pre><code class="language-json">
{
    "tile_map": "",
    "x": 24,
    "y": 20,
    "layer": 0,
    "time": 1.17,
    "Originalx": 0,
    "Originaly": 0,
    "rotation": 0,
    "flipH": false,
    "flipV": false
}
      </code></pre>
      <div class="alert alert-info">
        <div class="alert-body">
          <strong>Info :</strong> Un keyframe dont <code>tile_map</code> est vide indique une suppression de tuile √† cet instant.
        </div>
      </div>

      <h2 id="lights">üí° Lumi√®res</h2>
      <p>
        Les sources lumineuses sont enregistr√©es dans la section <code>lights</code> du JSON :
      </p>
      <pre><code class="language-json">
"lights": [
  {
    "x": 376.4,
    "y": 367.4,
    "radius": 59.79,
    "color": [255,180,80],
    "blink": false
  }
  /* ‚Ä¶ autres lights ‚Ä¶ */
]
      </code></pre>
      <ul>
        <li><code>x, y</code> : position dans le monde (coordonn√©es du centre)</li>
        <li><code>radius</code> : rayon d'√©clairage</li>
        <li><code>color</code> : couleur RGB</li>
        <li><code>blink</code> : clignotement activ√© ou non</li>
      </ul>
      <div class="alert alert-warning">
        <div class="alert-body">
          <strong>Attention :</strong> Si <code>globalIllumination</code> est √† 1.0, les lights ne sont pas actives ‚Äì baissez la valeur dans <code>settings.globalIllumination</code>.
        </div>
      </div>
      <h2 id="nodes">LevelGraph (Nodes)</h2>
      <p>
        Le chemin vers le fichier <code>.lvg</code> du graphe nodal est indiqu√© en fin de JSON :
      </p>
      <pre><code class="language-json">
"levelGraph": "C:\\‚Ä¶\\test_graph.lvg"
      </code></pre>
      <div class="alert alert-info">
        <div class="alert-body">
          <strong>Info :</strong> Au chargement, l'√©diteur essaie d'abord ce chemin absolu, puis un chemin relatif depuis le dossier du level si l'absolu √©choue.
        </div>
      </div>
      <h1>üóÉÔ∏è Format des fichiers LevelGraph (.lvg)</h1>

      <p>
        Le fichier <code>.lvg</code> stocke l'ensemble des graphes nodaux d'un niveau. Chaque graphe correspond √† un rectangle de collision dans l'√©diteur et contient des n≈ìuds connect√©s entre eux pour d√©finir des logiques de gameplay.
      </p>

      <div class="alert alert-info">
        <div class="alert-body">
          Lors de la sauvegarde d'un niveau, un fichier <code>.lvg</code> est automatiquement g√©n√©r√© dans le m√™me dossier que le niveau <code>.json</code>. Le chemin absolu de ce fichier est r√©f√©renc√© dans le champ <code>levelGraph</code> du fichier JSON principal.
        </div>
      </div>

      <h2>üîå Structure des donn√©es</h2>

      <pre><code class="language-json">{
  "graphs": [
    {
      "rect_id": "UUID_du_Rectangle",
      "nodes": [...],
      "connections": [...]
    }
  ]
}</code></pre>

      <ul>
        <li><strong><code>rect_id</code></strong> ‚Äî Identifiant unique du rectangle de collision associ√©.</li>
        <li><strong><code>nodes</code></strong> ‚Äî Liste des n≈ìuds plac√©s dans ce graphe, avec leur position et param√®tres.</li>
        <li><strong><code>connections</code></strong> ‚Äî Connexions entre les n≈ìuds via leurs pins (exec ou data).</li>
      </ul>

      <h2 id="example">üìÑ Exemple complet</h2>

      <p>Voici un exemple de graphe associ√© √† un rectangle de collision :</p>

      <pre><code class="language-json">{
  "rect_id": "2bfc28a5-7d5a-4fa4-8d41-81fc045b16f2",
  "nodes": [
    {
      "node_id": "on_enter_197_226",
      "label": "On Enter",
      "pos": [197, 226],
      "properties": {}
    },
    {
      "node_id": "Set SpawnPoint_670_244",
      "label": "Set SpawnPoint",
      "pos": [670, 244],
      "properties": {
        "choice": "point_0"
      }
    },
    {
      "node_id": "Sequence_437_261",
      "label": "Sequence",
      "pos": [437, 261],
      "properties": {}
    },
    {
      "node_id": "Teleport_923_339",
      "label": "Teleport",
      "pos": [923, 339],
      "properties": {
        "choice": "point_0"
      }
    },
    {
      "node_id": "Print Console_675_408",
      "label": "Print Console",
      "pos": [675, 408],
      "properties": {
        "value": "Hello World"
      }
    },
    {
      "node_id": "Get Player Health_543_498",
      "label": "Get Player Health",
      "pos": [543, 498],
      "properties": {
        "health": 200
      }
    }
  ],
  "connections": [
    {
      "out_node": "on_enter_197_226",
      "out_pin": "out",
      "in_node": "Sequence_437_261",
      "in_pin": "in"
    },
    {
      "out_node": "Sequence_437_261",
      "out_pin": "out0",
      "in_node": "Set SpawnPoint_670_244",
      "in_pin": "in"
    },
    {
      "out_node": "Sequence_437_261",
      "out_pin": "out1",
      "in_node": "Teleport_923_339",
      "in_pin": "in"
    },
    {
      "out_node": "Sequence_437_261",
      "out_pin": "out2",
      "in_node": "Print Console_675_408",
      "in_pin": "in"
    },
    {
      "out_node": "Get Player Health_543_498",
      "out_pin": "health",
      "in_node": "Print Console_675_408",
      "in_pin": "value"
    }
  ]
}</code></pre>

      <h3>üß† Analyse du graphe</h3>
      <ul>
        <li><code>On Enter</code> ‚Äî √âv√©nement d√©clench√© quand le joueur entre dans la collision.</li>
        <li><code>Sequence</code> ‚Äî Ex√©cute plusieurs branches dans l'ordre : spawnpoint ‚Üí t√©l√©portation ‚Üí console.</li>
        <li><code>Set SpawnPoint</code> ‚Äî D√©finit le point d'apparition.</li>
        <li><code>Teleport</code> ‚Äî T√©l√©porte le joueur √† un point nomm√© <code>point_0</code>.</li>
        <li><code>Print Console</code> ‚Äî Affiche dans la console le texte "Hello World" et y ajoute aussi la vie du joueur via le n≈ìud <code>Get Player Health</code>.</li>
      </ul>

      <h3>üß© Autre exemple de graphe (collision secondaire)</h3>

      <pre><code class="language-json">{
  "rect_id": "f4685698-3196-480a-b141-cdff2d4d86c7",
  "nodes": [
    {
      "node_id": "on_start_320_284",
      "label": "On Start",
      "pos": [320, 284],
      "properties": {}
    },
    {
      "node_id": "Set MaxHealth_550_354",
      "label": "Set MaxHealth",
      "pos": [550, 354],
      "properties": {
        "health": "20"
      }
    }
  ],
  "connections": [
    {
      "out_node": "on_start_320_284",
      "out_pin": "out",
      "in_node": "Set MaxHealth_550_354",
      "in_pin": "in"
    }
  ]
}</code></pre>

      <p>
        Ce graphe initialise la sant√© du joueur √† 20 au d√©but du mode <strong>Play</strong>.
      </p>

      <div class="alert alert-warning">
        <div class="alert-body">
          <strong>Remarque :</strong> Un m√™me √©v√©nement (par ex. <code>On Start</code>) ne peut appara√Ætre qu'une seule fois dans un m√™me graphe.
        </div>
      </div>


      <h2 id="parameters">Param√®tres</h2>
      <p>
        La section <code>settings</code> stocke les pr√©f√©rences de l'√©diteur pour ce niveau :
      </p>
      <pre><code class="language-json">
"settings": {
  "backgroundIndex": 21,
  "globalIllumination": 0.0,
  "start_mode": 0,
  "showLights": true,
  "showCollisions": true,
  "showLocationPoints": true,
  "playerSpawnPoint": null,
  "keyframeOverlay": true
}
      </code></pre>
      <div class="alert alert-warning">
        <div class="alert-body">
          <strong>Attention :</strong> Certaines options (ex. <code>playerSpawnPoint</code>) peuvent √™tre <code>null</code> si non d√©finies ; v√©rifiez leur existence avant utilisation.
        </div>
      </div>
  <h2 id="next-steps">Envie d'en savoir plus ?</h2>
  <p>
    Consultez les pages suivantes pour explorer les fonctionnalit√©s cl√©s de l'√©diteur :
  </p>
  <ul>
    <li>
      üîß <strong><a href="interface.html">Interface</a></strong> ‚Äî Comprendre les outils de dessin, la gestion des layers et le fonctionnement du viewport.
    </li>
    <li>
      üéûÔ∏è <strong><a href="animations.html">Animations</a></strong> ‚Äî Cr√©ez, √©ditez et d√©clenchez des animations dans vos niveaux √† l'aide de la timeline visuelle.
    </li>
<img src="../assets/images/sleep2.gif" alt="√âditeur Nodal en action" style="max-width:600px; margin-top:1em;" />

    </article>
  </div>
</main>

<aside class="sidebar-right" style="height: 145px;">
  <div class="toc">
    <strong>Sur cette page</strong>
    <ul>
      <li><a href="#level">Niveau</a></li>
      <li><a href="#tilemaps">TileMaps</a></li>
      <li><a href="#animations">Animations</a></li>
      <li><a href="#nodes">nodes</a></li>
      <li><a href="#parameters">Param√®tres</a></li>
    </ul>
  </div>
</aside>






  </div>

</body>
    <script src="../assets/js/script.js"></script>
</html>
